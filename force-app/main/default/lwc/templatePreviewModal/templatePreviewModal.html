<template>
  <div class="preview_mainDiv" style={popUpStyle}>
    <div class="preview_Contanier" style={widthStyleForGeneratePreview}>
      <div class="preview_SubContanier" style={widthStyleForGeneratePreview}>
        <div class="preview_leftSection" if:false={isCalledFromGenerateDoc}>
          <div class="titleSection">
            Preview Section
          </div>
          <div class="optionSection">
            <div class="recordSelectionSection">
              <c-custom-record-picker lwc:if={recordLabelField}
                label={label}
                placeholder={placeHolder}
                onchange={onRecordSelect}
                onerror={handleRecordPickerError}
                multiselect="false"
                dropdown-position="center"
                query-object-api={objectname}
                label-field-api={recordLabelField}
                label-field-type={recordLabelFieldType}
                description-field-api="CreatedBy.Name"
                search-by-fields={searchByField}
                show-footer-button="false"
                additional-fields="CreatedDate"
                disabled={disableRecordPicker}
              ></c-custom-record-picker>
            </div>
            <div class="buttonSection">
              <button class="generatePreviewBtn" title="Generate Preview" onclick={generatePreview} disabled={disableGenerateBtn}>
                <svg viewBox="0 0 32.00 32.00" transform="matrix(1, 0, 0, 1, 0, 0)rotate(0)"> <g stroke-linecap="round" stroke-linejoin="round"></g><g><circle class="eye-circle" cx="22" cy="24" r="2"></circle><path data-name="<inner path>" class="cls-1" style="fill: none;" d="M22,28a4,4,0,1,1,4-4A4.0039,4.0039,0,0,1,22,28Zm0-6a2,2,0,1,0,2,2A2.0027,2.0027,0,0,0,22,22Z"></path><path class="eye" d="M29.7769,23.4785A8.64,8.64,0,0,0,22,18a8.64,8.64,0,0,0-7.7769,5.4785L14,24l.2231.5215A8.64,8.64,0,0,0,22,30a8.64,8.64,0,0,0,7.7769-5.4785L30,24ZM22,28a4,4,0,1,1,4-4A4.0045,4.0045,0,0,1,22,28Z"></path><path d="M12,28H8V4h8v6a2.0058,2.0058,0,0,0,2,2h6v4h2V10a.9092.9092,0,0,0-.3-.7l-7-7A.9087.9087,0,0,0,18,2H8A2.0058,2.0058,0,0,0,6,4V28a2.0058,2.0058,0,0,0,2,2h4ZM18,4.4,23.6,10H18Z"></path><rect data-name="<Transparent Rectangle>" class="cls-1" style="fill: none;" width="32" height="32"></rect> </g></svg>
                  Generate Preview
              </button>
            </div>
          </div>
          <div class="buttonSection footerBtn">
            <button class="closeBtn" title="Close" onclick={closeTemplatePreview}>
              <svg viewBox="0 0 520 520" ><g><path d="M310 254l130-131c6-6 6-15 0-21l-20-21c-6-6-15-6-21 0L268 212a10 10 0 01-14 0L123 80c-6-6-15-6-21 0l-21 21c-6 6-6 15 0 21l131 131c4 4 4 10 0 14L80 399c-6 6-6 15 0 21l21 21c6 6 15 6 21 0l131-131a10 10 0 0114 0l131 131c6 6 15 6 21 0l21-21c6-6 6-15 0-21L310 268a10 10 0 010-14z"></path></g></svg>
              Close
            </button>
            <button class="exportBtn" title="Generate Document" onclick={generateDocument} disabled={disableGenerateBtn}>
              <svg viewBox="0 0 45.057 45.057" ><g  stroke-width="0"></g><g stroke-linecap="round" stroke-linejoin="round"></g><g> <g> <g > <g> <path d="M28.69,28.708c-0.014-0.318-0.049-0.634-0.113-0.938c0.438-0.375,1.314-1.125,1.314-1.125v-1.512l-2.16-2.518h-1.514 c0,0-0.717,0.614-1.074,0.922c-0.389-0.188-0.801-0.344-1.229-0.461c-0.035-0.426-0.105-1.279-0.105-1.279l-1.068-1.069 l-3.303,0.268l-1.069,1.069c0,0,0.091,1.123,0.135,1.683c-0.323,0.184-0.629,0.393-0.913,0.623 c-0.464-0.213-1.395-0.639-1.395-0.639l-1.463,0.385l-1.383,3.016l-0.049,0.205l0.433,1.258c0,0,1.079,0.492,1.62,0.739 c0.024,0.356,0.079,0.702,0.167,1.039c-0.412,0.348-1.235,1.048-1.235,1.048v1.512l2.142,2.528c0,0,1.246,0.147,1.313,0.11 s0.201-0.11,0.201-0.11s0.783-0.662,1.174-0.994c0.331,0.147,0.674,0.272,1.032,0.369c0.041,0.444,0.122,1.333,0.122,1.333 l1.069,1.068l3.298-0.301l1.068-1.068c0,0-0.104-1.146-0.154-1.719c0.27-0.154,0.527-0.324,0.771-0.513 c0.43,0.248,1.287,0.745,1.287,0.745l1.463-0.385l1.66-2.869l-0.383-1.463C30.349,29.666,29.243,29.025,28.69,28.708z M21.838,32.318c-1.841,0-3.334-1.494-3.334-3.336c0-1.843,1.493-3.334,3.334-3.334c1.842,0,3.336,1.491,3.336,3.334 C25.175,30.824,23.681,32.318,21.838,32.318z"></path> <path d="M30.565,14.072c-0.01-0.193-0.031-0.385-0.07-0.569c0.268-0.228,0.797-0.682,0.797-0.682v-0.917l-1.309-1.526h-0.918 c0,0-0.434,0.372-0.65,0.559c-0.236-0.114-0.486-0.208-0.746-0.279c-0.021-0.258-0.062-0.775-0.062-0.775l-0.648-0.648 l-2.004,0.162l-0.646,0.648c0,0,0.055,0.681,0.082,1.021c-0.197,0.111-0.381,0.237-0.555,0.378 c-0.281-0.13-0.846-0.387-0.846-0.387l-0.887,0.232l-0.839,1.828l-0.029,0.125l0.263,0.762c0,0,0.654,0.299,0.982,0.449 c0.014,0.216,0.047,0.425,0.101,0.63c-0.25,0.21-0.749,0.635-0.749,0.635v0.916l1.299,1.534c0,0,0.755,0.09,0.796,0.067 c0.041-0.022,0.121-0.067,0.121-0.067s0.475-0.402,0.713-0.604c0.199,0.09,0.408,0.165,0.625,0.224 c0.023,0.271,0.074,0.809,0.074,0.809l0.648,0.648l2-0.183l0.648-0.648c0,0-0.064-0.694-0.096-1.042 c0.164-0.094,0.322-0.196,0.469-0.31c0.262,0.15,0.781,0.451,0.781,0.451l0.887-0.233l1.006-1.739l-0.232-0.887 C31.569,14.653,30.899,14.264,30.565,14.072z M26.409,16.26c-1.115,0-2.02-0.905-2.02-2.021c0-1.117,0.904-2.022,2.02-2.022 c1.119,0,2.023,0.905,2.023,2.022C28.433,15.355,27.528,16.26,26.409,16.26z"></path> <path d="M33.431,0H5.179v45.057h34.699V6.251L33.431,0z M36.878,42.056H8.179V3h23.707v4.76h4.992V42.056z"></path> </g> </g> </g> </g></svg>
                Generate Document
            </button>
            <!-- <lightning-button variant="destructive slds-m-right_medium" label="Cancel" title="Cancel" onclick={closeTemplatePreview} icon-name="utility:close" icon-position="left"></lightning-button> -->
            <!-- <lightning-button variant="brand" label="Download" title="Downland" onclick={downloadFile} icon-name="utility:download" icon-position="left" disabled={disableGenerateBtn}></lightning-button> -->
          </div>
        </div>
        <div class="preview_rightSection" style={widthStyleForGeneratePreview}>
          <div class="iframe_outer">
            <template lwc:if={showPreview}> 
              <iframe lwc:if={vfGeneratePageSRC} class="generate_iframe" src={vfGeneratePageSRC} onload={fileDownloaded} width="0%" height="0%"></iframe>
              <template lwc:if={isSimpleTemplatePreview}>
                <iframe lwc:if={vfPageSRC} class="preview_iframe" data-id="vfPage" src={vfPageSRC} width="100%" height="100%" onload={contentLoaded}></iframe>
              </template>
              <template lwc:else >
                <c-preview-google-document
                  templateid={templateid}
                  record-id={selectedRecordId}
                  objectname={objectname}
                  oncontentloaded={contentLoaded}
                    ></c-preview-google-document>
              </template>
            </template>
            <template lwc:elseif={errorOccured}>
              <div class="errorMessageContainer">
                <div class="popupContainer">
                  <div class="popupBody">
                    <div class="topDesingSection">
                      <div class="curveDesign">
                          <svg class="ballDesignIcon" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewBox="0 0 24 24" >
                            <path d="M12 8v4m0 4h.01M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"></path>
                          </svg>
                      </div>
                    </div>
                    <div class="contentSection">
                      <div class="titleDiv">
                        <h2>{errorDetail.title}</h2>
                      </div>
                      <div class="messageDiv">
                        <p>{errorDetail.message}</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </template>
            <template lwc:else>
              <div class="loadingContainer">
                <img class="intiImg" src={previewModalImg} />
                <div class="loadingInfo">
                  {loadingInfo}
                </div>
              </div>
            </template>
            </div>
        </div>
      </div>
    </div>
  </div>

    <div class="customSetTimeout" data-name="customSetTimeout0"></div>
    <div class="customSetTimeout" data-name="customSetTimeout1"></div>
    <div class="customSetTimeout" data-name="customSetTimeout2"></div>
    <div class="customSetTimeout" data-name="customSetTimeout3"></div>
    <div class="customSetTimeout" data-name="customSetTimeout4"></div>
    <div class="customSetTimeout" data-name="customSetTimeout5"></div>
    <div class="customSetTimeout" data-name="customSetTimeout6"></div>
    <div class="customSetTimeout" data-name="customSetTimeout7"></div>
    <div class="customSetTimeout" data-name="customSetTimeout8"></div>
    <div class="customSetTimeout" data-name="customSetTimeout9"></div>
    <div class="customSetTimeout" data-name="customSetTimeout10"></div>

    <!-- <template for:each={customTimeoutProcessList} for:item="process">
      <div class="customSetTimeout" data-name={process.name} key={process.name}></div>
    </template> -->

  <!-- <template lwc:if={isSpinner}>
    <c-spinner></c-spinner>
  </template> -->
  <template lwc:if={isGenerate}>
    <c-generate-document
    record-id={selectedRecordId}
    object-api-name={objectname}
    template-id-from-parent={templateid}
    called-from-where = "preview"
    onclose = {closeGenerate}
  ></c-generate-document>
  </template>
  <c-document-loader display={isSpinner} label={spinnerLabel} full-size="true"></c-document-loader>
</template>